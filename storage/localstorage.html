<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<script type="text/javascript">
		
		function set(key){
			var src="123.jpg";
			var img=document.createElement('img');
			img.addEventListener("load",function(){
				var imgCanvas=document.createElement('canvas'),
					imgContext=imgCanvas.getContext('2d');
					imgCanvas.width=this.width;
					imgCanvas.height=this.height;
					imgContext.drawImage(this,0,0,this.width,this.height);
					var imgAsDateURL=imgCanvas.toDataURL("image/png");
					try{
						localStorage.setItem(key,imgAsDateURL);
					}catch(e){
						console.log('ok');
					}

			},false);
			img.src=src;
		}
		function get(key){
			var srcStr=localStorage.getItem(key);
			var imgObj=document.createElement('img');
			imgObj.src=srcStr;
			document.body.appendChild(imgObj);
		}
		window.onload=function(){
			
			set('my');
			get('my');
		}
	</script>
</head>
<body>
	
</body>
</html>